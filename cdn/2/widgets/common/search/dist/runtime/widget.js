System.register(["jimu-core","jimu-ui","jimu-core/react","jimu-arcgis"],(function(e,o){var t={},n={},r={},l={};return{setters:[function(e){t.AppMode=e.AppMode,t.ClauseLogic=e.ClauseLogic,t.ClauseOperator=e.ClauseOperator,t.DataRecordSetChangeMessage=e.DataRecordSetChangeMessage,t.DataRecordsSelectionChangeMessage=e.DataRecordsSelectionChangeMessage,t.DataSourceComponent=e.DataSourceComponent,t.DataSourceManager=e.DataSourceManager,t.DataSourceStatus=e.DataSourceStatus,t.Immutable=e.Immutable,t.JimuFieldType=e.JimuFieldType,t.MessageManager=e.MessageManager,t.QueryScope=e.QueryScope,t.React=e.React,t.ReactRedux=e.ReactRedux,t.RecordSetChangeType=e.RecordSetChangeType,t.classNames=e.classNames,t.css=e.css,t.dataSourceUtils=e.dataSourceUtils,t.esri=e.esri,t.jsx=e.jsx,t.lodash=e.lodash,t.polished=e.polished},function(e){n.Button=e.Button,n.Checkbox=e.Checkbox,n.Dropdown=e.Dropdown,n.DropdownButton=e.DropdownButton,n.DropdownItem=e.DropdownItem,n.DropdownMenu=e.DropdownMenu,n.Icon=e.Icon,n.Link=e.Link,n.Popper=e.Popper,n.TextInput=e.TextInput,n.defaultMessages=e.defaultMessages,n.hooks=e.hooks},function(e){r.useEffect=e.useEffect},function(e){l.loadArcGISJSAPIModules=e.loadArcGISJSAPIModules}],execute:function(){e((()=>{var e={20864:e=>{e.exports='<svg viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M13 6.133c0 .598-.28 1.46-.825 2.51-.53 1.02-1.247 2.102-1.981 3.102A45.718 45.718 0 018 14.492a48.01 48.01 0 01-2.194-2.747c-.734-1-1.451-2.081-1.98-3.102C3.28 7.593 3 6.731 3 6.133 3 3.277 5.26 1 8 1s5 2.277 5 5.133zm1 0c0 2.685-3.768 7.311-5.332 9.115C8.258 15.722 8 16 8 16s-.258-.279-.668-.752C5.768 13.444 2 8.819 2 6.133 2 2.746 4.686 0 8 0s6 2.746 6 6.133zM10 5.5a2 2 0 11-4 0 2 2 0 014 0zm1 0a3 3 0 11-6 0 3 3 0 016 0z" fill="#000"></path></svg>'},59788:e=>{e.exports='<svg viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M2.146 4.653a.485.485 0 01.708 0L8 10.24l5.146-5.587a.485.485 0 01.708 0 .538.538 0 010 .738l-5.5 5.956a.485.485 0 01-.708 0l-5.5-5.956a.538.538 0 010-.738z" fill="#000"></path></svg>'},96009:e=>{e.exports='<svg viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M13.854 11.347a.486.486 0 01-.708 0L8 5.76l-5.146 5.587a.485.485 0 01-.708 0 .538.538 0 010-.738l5.5-5.956a.485.485 0 01.708 0l5.5 5.956a.538.538 0 010 .738z" fill="#000"></path></svg>'},55339:e=>{e.exports='<svg viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M8.745 8l6.1 6.1a.527.527 0 11-.745.746L8 8.746l-6.1 6.1a.527.527 0 11-.746-.746l6.1-6.1-6.1-6.1a.527.527 0 01.746-.746l6.1 6.1 6.1-6.1a.527.527 0 01.746.746L8.746 8z" fill="#000"></path></svg>'},30224:e=>{e.exports='<svg viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M12 6.5a5.5 5.5 0 11-11 0 5.5 5.5 0 0111 0zm-1.27 4.936a6.5 6.5 0 11.707-.707l4.136 4.137a.5.5 0 11-.707.707l-4.137-4.137z" fill="#000"></path></svg>'},54357:e=>{e.exports='<svg viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M6 6.5a.5.5 0 011 0v6a.5.5 0 01-1 0v-6zM9.5 6a.5.5 0 00-.5.5v6a.5.5 0 001 0v-6a.5.5 0 00-.5-.5z" fill="#000"></path><path fill-rule="evenodd" clip-rule="evenodd" d="M11 0H5a1 1 0 00-1 1v2H.5a.5.5 0 000 1h1.6l.81 11.1a1 1 0 00.995.9h8.19a1 1 0 00.995-.9L13.9 4h1.6a.5.5 0 000-1H12V1a1 1 0 00-1-1zm0 3V1H5v2h6zm1.895 1h-9.79l.8 11h8.19l.8-11z" fill="#000"></path></svg>'},79964:e=>{e.exports='<svg viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M8 2.125L14.334 14H1.667L8 2.125zm-.882-.47a1 1 0 011.765 0l6.333 11.874A1 1 0 0114.334 15H1.667a1 1 0 01-.882-1.47L7.118 1.653zM8 4.874a.905.905 0 00-.9.995l.35 3.507a.552.552 0 001.1 0L8.9 5.87a.905.905 0 00-.9-.995zm1 7a1 1 0 11-2 0 1 1 0 012 0z" fill="#000"></path></svg>'},74645:e=>{"use strict";e.exports=l},1810:e=>{"use strict";e.exports=t},52127:e=>{"use strict";e.exports=r},21835:e=>{"use strict";e.exports=n}},o={};function s(t){var n=o[t];if(void 0!==n)return n.exports;var r=o[t]={exports:{}};return e[t](r,r.exports,s),r.exports}s.n=e=>{var o=e&&e.__esModule?()=>e.default:()=>e;return s.d(o,{a:o}),o},s.d=(e,o)=>{for(var t in o)s.o(o,t)&&!s.o(e,t)&&Object.defineProperty(e,t,{enumerable:!0,get:o[t]})},s.o=(e,o)=>Object.prototype.hasOwnProperty.call(e,o),s.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.p="";var i={};return s.p=window.jimuConfig.baseUrl,(()=>{"use strict";s.r(i),s.d(i,{default:()=>De});var e,o,t,n,r=s(1810);!function(e){e.GeocodeService="GeocodeService",e.FeatureService="FeatureService"}(e||(e={})),function(e){e.ResultPanel="Result_Panel",e.OtherWidgets="Other_Widgets"}(o||(o={})),function(e){e.Style1="Style1",e.Style2="Style2"}(t||(t={})),function(e){e.None="",e.Init="init",e.Loading="loading",e.Loaded="loaded",e.Warning="warning",e.Error="error"}(n||(n={}));var l=s(21835),a=s(52127);const c={_widgetLabel:"Search",findAddressOrPlace:"Find addres or place",showResult:"Show search results for {searchText}",hideResult:"Hide search results for {searchText}",allSearchSources:"All search sources",useCurrentLocation:"Use current location",noResult:'No results found for "{searchText}"',couldNotRetrieve:"Could not retrieve current location.",recentSearches:"Recent searches",showMoreResult:"Show more results",clearAllHistories:"Clear all histories",clearHistorie:"Clear history",clearThisHistories:"Remove this history",clearRecentSearches:"Recent searches",searchIn:"Search in {value}"};var u=s(59788),d=s.n(u);const v=e=>{const{className:o}=e,t=function(e,o){var t={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&o.indexOf(n)<0&&(t[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(n=Object.getOwnPropertySymbols(e);r<n.length;r++)o.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(e,n[r])&&(t[n[r]]=e[n[r]])}return t}(e,["className"]),n=(0,r.classNames)("jimu-icon-component",o);return r.React.createElement(l.Icon,Object.assign({className:n,icon:d()},t))};var g=s(96009),p=s.n(g);const m=e=>{const{className:o}=e,t=function(e,o){var t={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&o.indexOf(n)<0&&(t[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(n=Object.getOwnPropertySymbols(e);r<n.length;r++)o.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(e,n[r])&&(t[n[r]]=e[n[r]])}return t}(e,["className"]),n=(0,r.classNames)("jimu-icon-component",o);return r.React.createElement(l.Icon,Object.assign({className:n,icon:p()},t))},{useRef:h,useState:f}=r.React,S=e=>{const o=l.hooks.useTranslate(c,l.defaultMessages),t=r.css`
    & {
      box-sizing: border-box;
      width: ${r.polished.rem(32)}
    }
    .setting-dropdown-button {
      border-radius: 0;
      svg {
        margin: 0 !important;
      }
    }
  `,[n,s]=f(!0),[i,u]=r.React.useState(!1),{className:d,datasourceConfig:g,onDatasourceConfigChange:p}=e,S=h(null);return(0,a.useEffect)((()=>{var e;const o=0===(null===(e=null==g?void 0:g.filter((e=>!(null==e?void 0:e.enable))))||void 0===e?void 0:e.length);s(o)}),[g]),(0,r.jsx)("div",{className:`${d||""}`,css:t},(0,r.jsx)(l.Dropdown,{className:"w-100 h-100",toggle:e=>{var o;const t=null==e?void 0:e.target;if(null===(o=null==S?void 0:S.current)||void 0===o?void 0:o.contains(t))return!1;u(!i)},isOpen:i},(0,r.jsx)(l.DropdownButton,{className:"h-100 setting-dropdown-button",arrow:!1,icon:!0,title:o("searchIn",{value:""})},!i&&(0,r.jsx)(v,{size:16,className:"mr-1 d-inline-block",autoFlip:!0}),i&&(0,r.jsx)(m,{size:16,className:"mr-1 d-inline-block",autoFlip:!0})),(0,r.jsx)(l.DropdownMenu,{trapFocus:!1,autoFocus:!1,style:{maxHeight:"auto"}},(0,r.jsx)("div",{ref:S},(0,r.jsx)(l.DropdownItem,{onClick:()=>{const e=null==g?void 0:g.map((e=>{var o;return null===(o=e.setIn(["enable"],!0))||void 0===o?void 0:o.asMutable({deep:!0})}));p(e)},disabled:n},(0,r.jsx)(l.Checkbox,{checked:n,disabled:n,className:"mr-2"}),o("all")),(0,r.jsx)(l.DropdownItem,{divider:!0}),null==g?void 0:g.map(((e,o)=>{var t;const n=1===(null===(t=null==g?void 0:g.filter((e=>null==e?void 0:e.enable)))||void 0===t?void 0:t.length)&&(null==e?void 0:e.enable);return(0,r.jsx)(l.DropdownItem,{key:`${null==e?void 0:e.label}${o}`,disabled:n,onClick:()=>{((e,o)=>{var t;const n=null===(t=g)||void 0===t?void 0:t.setIn([o,"enable"],e);p(n)})(!(null==e?void 0:e.enable),o)}},(0,r.jsx)(l.Checkbox,{checked:null==e?void 0:e.enable,disabled:n,className:"mr-2"}),null==e?void 0:e.label)}))))))};var y=s(74645);const x="objectid",b="address",I={alias:"OBJECTID",type:"oid",name:x},w={alias:"ADDRESS",type:"string",name:b},j=Object.assign(Object.assign({},w),{jimuName:b}),R=(e,o)=>_(null==o?void 0:o.outputDataSourceId)?O(o,e):Promise.resolve({}),O=(e,o)=>M(null==e?void 0:e.geocodeURL,o,null==e?void 0:e.maxSuggestions).then((t=>{let n=[];t.forEach(((t,r)=>{const l=t.text,s=new RegExp(`(${o})`,"gi");if(l&&!A(n,l)&&l.match(s)){const r={suggestionHtml:B(l,o),suggestion:l,configId:null==e?void 0:e.configId,magicKey:null==t?void 0:t.magicKey};n.push(r)}})),n=E(n,"suggestion");const r={suggestionItem:n.splice(0,e.maxSuggestions),layer:null==e?void 0:e.label,icon:null==e?void 0:e.icon};return Promise.resolve(r)})).catch((e=>Promise.reject(e))),N=(e,o,t,n)=>{if(_(null==t?void 0:t.outputDataSourceId))return G(L(t.outputDataSourceId),r.DataSourceStatus.NotReady),C({address:e,maxResultNumber:o,searchResultView:n,geocodeItem:t})},C=e=>{const{address:t,maxResultNumber:n,searchResultView:l,geocodeItem:s}=e,{outputDataSourceId:i}=s,a=L(i);return D(s,t,n).then((e=>(0,y.loadArcGISJSAPIModules)(["esri/layers/FeatureLayer","esri/Graphic"]).then((s=>{const[c,u]=s;let d,v=null==e?void 0:e.filter((e=>null==e?void 0:e.address));v=l===o.ResultPanel?null==v?void 0:v.splice(0,n):v;const g=null==v?void 0:v.map(((e,o)=>{const t=e.attributes;return t.address=e.address,t.objectid=o,d=e.extent,new u({attributes:t,geometry:e.location})})),p=new c({id:`${i}_layer`,fields:[I,w],objectIdField:x,geometryType:"point",source:g,fullExtent:d});a.layer=p;const m=t?r.DataSourceStatus.Unloaded:r.DataSourceStatus.NotReady;return G(a,m),Promise.resolve(r.DataSourceStatus.Unloaded)})))).catch((e=>Promise.reject(e)))},D=(e,o,t)=>{const{geocodeURL:n,magicKey:l}=e;return(0,y.loadArcGISJSAPIModules)(["esri/tasks/Locator"]).then((e=>{const[s]=e,i=new s({url:n});let a=(0,r.Immutable)({SingleLine:o,maxSuggestions:t});return l&&(a=a.set("magicKey",l)),i.addressToLocations({address:null==a?void 0:a.asMutable({deep:!0})},{query:{}}).then((e=>(e=e.sort(((e,o)=>o.score-e.score))).filter((e=>e.location))),(e=>(console.error(e.message),[])))}))},M=(e,o,t)=>(0,y.loadArcGISJSAPIModules)(["esri/tasks/Locator"]).then((n=>{const[r]=n;return new r({url:e}).suggestLocations({text:o,maxSuggestions:t},{query:{}}).then((e=>e||[]),(e=>(console.error(e.message),[])))})),P=(e,o,t,n=!1)=>{const l=null==e?void 0:e.outputDataSourceId,s=L(null==e?void 0:e.outputDataSourceId),i={where:"1=1",pageSize:o,page:1,returnGeometry:!0};return null==s?void 0:s.load(i,{widgetId:t}).then((o=>(n&&T(l,t,[],r.RecordSetChangeType.Remove),setTimeout((()=>{n&&T(l,t,o)}),100),Promise.resolve({records:o,configId:e.configId,dsId:l,isGeocodeRecords:!0}))))},T=(e,o,t,n=r.RecordSetChangeType.Update)=>{const l=L(e),s=new r.DataRecordSetChangeMessage(o,e,n,{records:t,dataSource:l});r.MessageManager.getInstance().publishMessage(s)},k=(o,t,n,r=!1)=>{const l=[];for(const s in o){const i=o[s];let a;a=i.searchServiceType===e.FeatureService?K(i,t,n):P(i,t,n,r),l.push(a)}return Promise.all(l)},L=e=>e?r.DataSourceManager.getInstance().getDataSource(e):null,E=(e,o)=>{const t=e[0]?[e[0]]:[];for(let n=1;n<e.length;n++){const r=e[n];let l=!1;for(let e=0;e<t.length;e++)if(r[o]===t[e][o]){l=!0;break}l||t.push(r)}return t},F=e=>{const o=`${e}_recent_searches`;let t=localStorage.getItem(o);return t&&(t=unescape(t)),t?null==t?void 0:t.split("/@/"):[]},$=(e,o)=>{var t,n,r;return null===(r=null===(n=null===(t=null==e?void 0:e.asMutable({deep:!0}))||void 0===t?void 0:t.datasourceConfig)||void 0===n?void 0:n.filter((e=>e.configId===o)))||void 0===r?void 0:r[0]},z=e=>{let o=0;for(const t in e)o++;return o};function A(e,o){return e.filter((e=>o===(null==e?void 0:e.suggestion))).length>0}function B(e,o){if(!o)return e;const t=new RegExp(`(${o})`,"gi"),n=new RegExp(`(${o})`,"gi");return e.match(t)?e.replace(n,"<strong >$1</strong>"):e}function G(e,o){e.setStatus(o),e.setCountStatus(o)}function _(e){return!!e&&!!L(e)}var U=function(e,o,t,n){return new(t||(t=Promise))((function(r,l){function s(e){try{a(n.next(e))}catch(e){l(e)}}function i(e){try{a(n.throw(e))}catch(e){l(e)}}function a(e){var o;e.done?r(e.value):(o=e.value,o instanceof t?o:new t((function(e){e(o)}))).then(s,i)}a((n=n.apply(e,o||[])).next())}))};function H(e,o,t){var n,l;return U(this,void 0,void 0,(function*(){const s=(null==o?void 0:o.datasourceConfig)||[];if(!_(null===(n=null==t?void 0:t.useDataSource)||void 0===n?void 0:n.dataSourceId))return Promise.resolve({});const i=(null==t?void 0:t.searchFields)||[],a=null===(l=null==s?void 0:s.filter((e=>(null==e?void 0:e.configId)===t.configId)))||void 0===l?void 0:l[0];return function(e,o,t,n,l){var s;return U(this,void 0,void 0,(function*(){const{label:i,icon:a,configId:c}=t,u=null===(s=null==o?void 0:o.useDataSource)||void 0===s?void 0:s.dataSourceId,d=L(u),v=null==o?void 0:o.SQL,g={outFields:n.map((e=>e.name)),returnDistinctValues:!0,returnGeometry:!1};((null==v?void 0:v.sql)||"string"==typeof(null==v?void 0:v.sql))&&(g.where=null==v?void 0:v.sql);const p=new RegExp(`(${e})`,"gi");return function(e,o){return U(this,void 0,void 0,(function*(){return o?yield o.query(e,{scope:r.QueryScope.InConfigView}).then((e=>U(this,void 0,void 0,(function*(){return yield function(e,o){return U(this,void 0,void 0,(function*(){return yield Promise.resolve((null==o?void 0:o.records)||[])}))}(0,e)})))):yield Promise.resolve([])}))}(g,d).then((o=>U(this,void 0,void 0,(function*(){let t=[];n.forEach((n=>{o.forEach((o=>{var r;const l=(null===(r=null==o?void 0:o.feature)||void 0===r?void 0:r.attributes[null==n?void 0:n.name])+"";if(l&&!A(t,l)&&l.match(p)){const o={suggestionHtml:B(l,e),suggestion:l,configId:c,isFromSuggestion:!0};t.push(o)}}))})),t=E(t,"suggestion");const r={suggestionItem:t.splice(0,l),layer:i,icon:a};return Promise.resolve(r)})))).catch((e=>Promise.resolve({suggestionItem:[],layer:null,icon:null})))}))}(e,t,a,i,null==o?void 0:o.maxSuggestions)}))}function J(e,o,t,n){if(o){const l=[];o.forEach((o=>{if(o.type===r.JimuFieldType.Number&&!Number(e))return!1;const t=function(e,o){let t;return e===r.JimuFieldType.Number?t=r.ClauseOperator.NumberOperatorIs:e===r.JimuFieldType.String&&(t=o?r.ClauseOperator.StringOperatorIs:r.ClauseOperator.StringOperatorContains),t}(o.type,n),s=o.type===r.JimuFieldType.Number?Number(e):e,i=r.dataSourceUtils.createSQLClause(null==o?void 0:o.name,t,s);l.push(i)}));const s=r.dataSourceUtils.createSQLExpression(r.ClauseLogic.Or,l);return r.dataSourceUtils.getArcGISSQL(s,t)}}function q(e,o,t){var n;const l=null===(n=null==e?void 0:e.useDataSource)||void 0===n?void 0:n.dataSourceId,s=L(l),i=null==e?void 0:e.SQL,a=t?(null==i?void 0:i.sql)||"1=0":"1=1",c=(0,r.Immutable)({outFields:"*",where:a,returnGeometry:!0});s&&s.updateQueryParams(c,o)}const K=(e,o,t)=>{var n,r;const l=null===(n=null==e?void 0:e.useDataSource)||void 0===n?void 0:n.dataSourceId;if(!_(l))return Promise.resolve({});const s=L(l),i={where:(null===(r=null==e?void 0:e.SQL)||void 0===r?void 0:r.sql)||"1=0",pageSize:o,page:1,returnGeometry:!0};return null==s?void 0:s.load(i,{widgetId:t}).then((o=>Promise.resolve({records:o,configId:e.configId,dsId:l,isGeocodeRecords:!1})))};var Q=s(54357),V=s.n(Q);const W=e=>{const{className:o}=e,t=function(e,o){var t={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&o.indexOf(n)<0&&(t[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(n=Object.getOwnPropertySymbols(e);r<n.length;r++)o.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(e,n[r])&&(t[n[r]]=e[n[r]])}return t}(e,["className"]),n=(0,r.classNames)("jimu-icon-component",o);return r.React.createElement(l.Icon,Object.assign({className:n,icon:V()},t))};var X=s(20864),Y=s.n(X);const Z=e=>{const{className:o}=e,t=function(e,o){var t={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&o.indexOf(n)<0&&(t[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(n=Object.getOwnPropertySymbols(e);r<n.length;r++)o.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(e,n[r])&&(t[n[r]]=e[n[r]])}return t}(e,["className"]),n=(0,r.classNames)("jimu-icon-component",o);return r.React.createElement(l.Icon,Object.assign({className:n,icon:Y()},t))};var ee=s(79964),oe=s.n(ee);const te=e=>{const{className:o}=e,t=function(e,o){var t={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&o.indexOf(n)<0&&(t[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(n=Object.getOwnPropertySymbols(e);r<n.length;r++)o.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(e,n[r])&&(t[n[r]]=e[n[r]])}return t}(e,["className"]),n=(0,r.classNames)("jimu-icon-component",o);return r.React.createElement(l.Icon,Object.assign({className:n,icon:oe()},t))},{useState:ne}=r.React,re=o=>{const t=l.hooks.useTranslate(c,l.defaultMessages),{serviceList:n,onLocationChange:s}=o,[i,a]=ne(!1),[u,d]=r.React.useState(null);r.React.useEffect((()=>{v()}),[n]);const v=()=>{for(const o in n){const t=n[o];if(t.searchServiceType===e.GeocodeService){d(t);break}}},g=e=>{const o=`${e.coords.longitude},${e.coords.latitude}`;u?((e,o)=>o?(0,y.loadArcGISJSAPIModules)(["esri/tasks/Locator"]).then((t=>{const[n]=t,r=new n({url:e});return(e=>{const o=e&&e.coords;return o?(0,y.loadArcGISJSAPIModules)(["esri/geometry/Point"]).then((e=>{const[t]=e;return new t({longitude:o.longitude,latitude:o.latitude,z:o.altitude||null,spatialReference:{wkid:4326}})})):Promise.resolve(null)})(o).then((e=>r.locationToAddress({location:e},{query:{}}).then((e=>Promise.resolve(e.address)),(e=>(console.error(e.message),[])))))})):Promise.resolve(null))(null==u?void 0:u.geocodeURL,e).then((e=>{s(e)})):s(o)},p=()=>{a(!0)};return(0,r.jsx)("div",null,!i&&(0,r.jsx)(l.Button,{onClick:()=>{var e,o;e=g,o=p,navigator.geolocation?navigator.geolocation.getCurrentPosition(e,o):o&&o()}},(0,r.jsx)(Z,null),t("useCurrentLocation")),i&&(0,r.jsx)(l.Button,null,(0,r.jsx)(te,null),t("couldNotRetrieve")))},{useSelector:le}=r.ReactRedux,se=new(0,r.esri.Sanitizer),ie=e=>{var o;const t=l.hooks.useTranslate(c,l.defaultMessages),{isRecentSearches:n,className:s,reference:i,searchSuggestion:a,isOpen:u,searchText:d,canUseOutoutDsLength:v,serviceList:g,isShowCurrentLocation:p,toggel:m,onRecordItemClick:h,clearSearches:f}=e,S=le((e=>null==e?void 0:e.theme)),y=r.css`
    & {
      max-height: ${r.polished.rem(300)};
      min-width: ${r.polished.rem(null===(o=null==i?void 0:i.current)||void 0===o?void 0:o.clientWidth)};
      overflow: auto;
    }
    button {
      display: block;
      width: 100%;
      text-align: left;
      border: none;
      border-radius: 0;
    }
    button:hover {
      border: none;
    }
  `;return(0,r.jsx)(l.Popper,{css:y,placement:"bottom-start",reference:i,offset:[0,8],open:u,trapFocus:!1,autoFocus:!1,toggle:m,className:s},!d&&p&&(0,r.jsx)(re,{serviceList:g,isShowCurrentLocation:!0,onLocationChange:h}),(()=>{let e=[];return a.forEach((o=>{const t=(null==o?void 0:o.suggestionItem)||[];e=e.concat(t)})),d&&0===e.length})()&&(0,r.jsx)(l.Button,{className:"text-center",disabled:!0},t("noResult",{searchText:d})),null==a?void 0:a.map(((e,o)=>{var t,n,s;const i=(null==a?void 0:a.length)>1&&(null===(t=null==e?void 0:e.suggestionItem)||void 0===t?void 0:t.length)>0;return(0,r.jsx)("div",{key:`${null==e?void 0:e.layer}-${o}`},i&&(0,r.jsx)(l.Button,{disabled:!0},(null==e?void 0:e.icon)&&(0,r.jsx)(l.Icon,{color:null===(n=null==S?void 0:S.colors)||void 0===n?void 0:n.primary,size:16,icon:null===(s=null==e?void 0:e.icon)||void 0===s?void 0:s.svg}),null==e?void 0:e.layer),(e=>{const o=null==e?void 0:e.suggestionItem,t=null==e?void 0:e.icon;return null==o?void 0:o.map(((o,n)=>{var s;const i=se.sanitize(o.suggestionHtml),a={configId:null==o?void 0:o.configId,isFromSuggestion:null==o?void 0:o.isFromSuggestion,magicKey:null==o?void 0:o.magicKey};return(0,r.jsx)(l.Button,{className:"d-flex align-items-center",key:`${null==e?void 0:e.layer}${n}`,onClick:()=>{((e,o)=>{const{configId:t,isFromSuggestion:n,magicKey:r}=o||{};t&&(n||r)?h(e,o):h(e)})(o.suggestion,a)}},t&&1===v&&(0,r.jsx)(l.Icon,{color:null===(s=null==S?void 0:S.colors)||void 0===s?void 0:s.primary,size:16,icon:null==t?void 0:t.svg}),(0,r.jsx)("div",{className:"flex-grow-1",dangerouslySetInnerHTML:{__html:i}}))}))})(e))})),n&&(0,r.jsx)(l.DropdownItem,{divider:!0}),n&&(0,r.jsx)(l.Button,{type:"secondary",onClick:f},(0,r.jsx)(W,null),t("clearRecentSearches")))},ae=new(0,r.esri.Sanitizer),{useEffect:ce,useRef:ue}=r.React,{useSelector:de}=r.ReactRedux,ve=o=>{var t;const n=l.hooks.useTranslate(c),{className:s,reference:i,searchText:a,id:u,config:d,serviceList:v}=o,{resultMaxNumber:g}=d,p=ue([]),m=ue(null),h=ue(!1);let f={};const S=de((e=>null==e?void 0:e.theme)),y=de((e=>{var o;const t=null===(o=null==e?void 0:e.appRuntimeInfo)||void 0===o?void 0:o.currentPageId;return(null==m?void 0:m.current)||(m.current=t),t})),x=r.css`
    & {
      max-height: ${r.polished.rem(300)};
      min-width: ${r.polished.rem(null===(t=null==i?void 0:i.current)||void 0===t?void 0:t.clientWidth)};
      overflow: auto;
    }
    button {
      display: block;
      width: 100%;
      text-align: left;
      border: none;
      border-radius: 0;
    }
    button:hover {
      border: none;
    }
  `,[b,I]=r.React.useState((0,r.Immutable)({})),[w,R]=r.React.useState({}),[O,N]=r.React.useState(null),[C,D]=r.React.useState(!0),[M,P]=r.React.useState(!0),[T,E]=r.React.useState(!1);ce((()=>{F()}),[v]),ce((()=>{p.current=[]}),[a]),ce((()=>{const e=m.current===y;P(e)}),[y]);const F=()=>{h.current=!1;const e=k(null==v?void 0:v.asMutable({deep:!0}),g,u);Promise.all([e]).then((e=>{h.current=!0;let o=b||(0,r.Immutable)({}),t=[];null==e||e.forEach((e=>{t=t.concat(e)}));const n={};t.forEach((e=>{const{records:t,configId:r,dsId:l,isGeocodeRecords:s}=e;n[r]=t;const i=J(t,r,l,s);o=o.setIn([r],i)})),R(n),I(o),Q(),A()}))},A=()=>{var o;if(V())return;const t=[];for(const n in v){const r=v[n],l=(null==r?void 0:r.searchServiceType)===e.GeocodeService?null==r?void 0:r.outputDataSourceId:null===(o=null==r?void 0:r.useDataSource)||void 0===o?void 0:o.dataSourceId,s=B(l,n);s&&t.push(s)}const n=G(t,null==p?void 0:p.current);p.current=t,n&&n[0]?N(n[0]):N(null)},B=(e,o)=>{var t;const n=L(e).getSelectedRecords(),r=null===(t=null==n?void 0:n[0])||void 0===t?void 0:t.getId();return n&&r?K(o,r):null},G=(e,o)=>(null==e?void 0:e.length)>(null==o?void 0:o.length)?e.concat(o).filter((t=>!e.includes(t)||!o.includes(t)))||[]:e||[],_=e=>{const{isActive:o,recordId:t,dsId:n,configId:l}=e,s=L(n),i=o?[]:H(l,t);r.MessageManager.getInstance().publishMessage(new r.DataRecordsSelectionChangeMessage(u,i)),t&&(o?s.selectRecordsByIds([]):s.selectRecordsByIds([t]),!o&&U(l))},U=e=>{var o,t;for(const n in b)if(e!==n){const e=null===(t=null===(o=b[n])||void 0===o?void 0:o[0])||void 0===t?void 0:t.outputDsId,r=L(e);r&&r.selectRecordsByIds([])}},H=(e,o)=>{const t=(null==w?void 0:w[e])||[];return(null==t?void 0:t.filter((e=>(null==e?void 0:e.getId())===o)))||[]},J=(e,o,t,n)=>{var r;const l=(null===(r=null==v?void 0:v[o])||void 0===r?void 0:r.displayFields)||[],s=n?[j]:l,i=[];return null==e||e.forEach((e=>{const n=[];s.forEach((o=>{const t=e.getFieldValue(o.jimuName);t&&n.push(t)}));const r={value:n,configId:o,outputDsId:t,recordId:null==e?void 0:e.getId()};i.push(r),q(r)})),i},q=e=>{!(null==f?void 0:f.recordId)&&e.recordId&&(f=e)},K=(e,o)=>`${e}_${o}`,Q=()=>{if(!(null==d?void 0:d.isAutoSelectFirstResult)||!(null==f?void 0:f.recordId)||T)return;const{configId:e,recordId:o,outputDsId:t}=f,n=K(e,o);_({isActive:!1,key:n,recordId:o,dsId:t,configId:e}),E(!0)},V=()=>{var e;let o=0;for(const t in b)o+=(null===(e=null==b?void 0:b[t])||void 0===e?void 0:e.length)||0;return 0===o&&h.current};return(0,r.jsx)("div",null,(0,r.jsx)(l.Popper,{css:x,placement:"bottom-start",reference:i,offset:[0,8],open:!C&&!!a&&M,trapFocus:!1,autoFocus:!1,toggle:()=>{},className:s},(0,r.jsx)(l.Button,{onClick:()=>{D(!0)},dangerouslySetInnerHTML:{__html:ae.sanitize(n("showResult",{searchText:`<b>${a}</b>`}))}})),(0,r.jsx)(l.Popper,{css:x,placement:"bottom-start",reference:i,offset:[0,8],open:C&&M,trapFocus:!1,autoFocus:!1,toggle:()=>{V()||D(!C)},className:s},V()&&(0,r.jsx)(l.Button,{className:"text-center",disabled:!0},n("noResult",{searchText:a})),!V()&&(()=>{var e,o;const t=[];for(const s in b){const i=null===(e=null==b?void 0:b.asMutable({deep:!0}))||void 0===e?void 0:e[s],a=$(d,s),c=null==a?void 0:a.label,u=null==a?void 0:a.icon,g=z(v),p=(0,r.jsx)("div",{key:`${s}_${c}_con`},i.length>0&&(0,r.jsx)("div",null,g>1&&(0,r.jsx)(l.Button,{disabled:!0,key:`${s}_${c}`},u&&(0,r.jsx)(l.Icon,{color:null===(o=null==S?void 0:S.colors)||void 0===o?void 0:o.primary,size:16,icon:null==u?void 0:u.svg}),c),null==(n=i)?void 0:n.map(((e,o)=>{var t,n;const{configId:s,value:i,recordId:a,outputDsId:c}=e,u=K(s,a),g=O===u,p=$(d,s),m=null==p?void 0:p.icon,h=g?null===(t=null==S?void 0:S.colors)||void 0===t?void 0:t.white:null===(n=null==S?void 0:S.colors)||void 0===n?void 0:n.primary,f=z(v);return(0,r.jsx)(l.Button,{className:"d-flex align-items-center",key:u,active:g,onClick:()=>{_({isActive:g,key:u,recordId:a,dsId:c,configId:s})}},m&&1===f&&(0,r.jsx)(l.Icon,{color:h,size:16,icon:null==m?void 0:m.svg}),(0,r.jsx)("div",null,i.join(", ")))}))));t.push(p)}var n;return t})()))};var ge=s(30224),pe=s.n(ge);const me=e=>{const{className:o}=e,t=function(e,o){var t={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&o.indexOf(n)<0&&(t[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(n=Object.getOwnPropertySymbols(e);r<n.length;r++)o.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(e,n[r])&&(t[n[r]]=e[n[r]])}return t}(e,["className"]),n=(0,r.classNames)("jimu-icon-component",o);return r.React.createElement(l.Icon,Object.assign({className:n,icon:pe()},t))};var he=s(55339),fe=s.n(he);const Se=e=>{const{className:o}=e,t=function(e,o){var t={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&o.indexOf(n)<0&&(t[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(n=Object.getOwnPropertySymbols(e);r<n.length;r++)o.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(e,n[r])&&(t[n[r]]=e[n[r]])}return t}(e,["className"]),n=(0,r.classNames)("jimu-icon-component",o);return r.React.createElement(l.Icon,Object.assign({className:n,icon:fe()},t))},{useSelector:ye}=r.ReactRedux,{useState:xe,useEffect:be,useRef:Ie,useMemo:we}=r.React,je=n=>{var s,i,a,u,d,v;const g=l.hooks.useTranslate(c,l.defaultMessages),p=ye((e=>null==e?void 0:e.theme)),m=ye((e=>null==e?void 0:e.queryObject)),h=ye((e=>{var o;return null===(o=null==e?void 0:e.appRuntimeInfo)||void 0===o?void 0:o.appMode})),f=Ie((e=>{})),S=Ie(null),y=Ie(null),{config:x,className:b,reference:I,id:w,datasourceConfig:j,isShowSearchInput:O,onShowSearchInputChange:C}=n,{isShowRecentSearches:D,recentSearchesMaxNumber:M,linkParam:P,searchResultView:E,resultMaxNumber:$,arrangementStyle:A}=x,[B,U]=xe(null),[K,Q]=xe(!1),[V,W]=xe(!1),[X,Y]=xe(!1),[Z,ee]=xe({}),[oe,te]=xe({}),[ne,re]=xe([]),[le,se]=xe(!1),ae=r.css`
    .input-wrapper {
      height: 100% !important;
    }
    .loading-con {
      @keyframes loading {
        0% {transform: rotate(0deg); };
        100% {transform: rotate(360deg)};
      }
      width: ${r.polished.rem(16)};
      height: ${r.polished.rem(16)};
      min-width: ${r.polished.rem(16)};
      border: 2px solid ${null===(a=null===(i=null===(s=null==p?void 0:p.colors)||void 0===s?void 0:s.palette)||void 0===i?void 0:i.secondary)||void 0===a?void 0:a[300]};
      border-radius: 50%;
      border-top: 2px solid ${null===(v=null===(d=null===(u=null==p?void 0:p.colors)||void 0===u?void 0:u.palette)||void 0===d?void 0:d.primary)||void 0===v?void 0:v[500]};
      box-sizing: border-box;
      animation:loading 2s infinite linear;
      box-sizing: border-box;
    }
    .search-button {
      width: ${r.polished.rem(32)};
      border-radius: 0;
    }
    .search-input-con input{
      width: 100%;
    }
    .search-link-con {
      width: 0;
      height: 0;
      overflow: hidden;
    }
  `;be((()=>{Me()}),[j]),be((()=>{le&&h===r.AppMode.Design&&se(!1)}),[h]),be((()=>{f.current=r.lodash.debounce((o=>{const t=((o,t,n)=>{const r=[];for(const l in t){const s=t[l];let i;i=s.searchServiceType===e.FeatureService?H(o,n,s):R(o,s),r.push(i)}return Promise.all(r)})(o,oe,x);Promise.all([t]).then((e=>{const o=null==e?void 0:e[0];Q(!1),o&&re(o),W(!0)})).catch((e=>{Q(!1)}))}),400)}),[oe,x]);const ce=()=>{var o,t;for(const n in oe)if((null===(o=oe[n])||void 0===o?void 0:o.searchServiceType)===e.GeocodeService){const e=null===(t=oe[n])||void 0===t?void 0:t.outputDataSourceId;G(L(e),r.DataSourceStatus.NotReady),T(e,w,[],r.RecordSetChangeType.Remove)}},ue=e=>{se(e)},de=()=>{let e=!0;if(!y.current)return e;const o=y.current;for(const t in o){const n=o[t];if(e=!((null==n?void 0:n.magicKey)||(null==n?void 0:n.isFromSuggestion)),!e)break}return e},ge=(t,n=!1)=>{le&&!n||(Re(t),W(!1),(t=>{const{serviceList:n,searchText:r,searchResultView:l,id:s}=t,i=[];for(const t in n){const a=n[t],{searchServiceType:c,resultMaxNumber:u}=a;if(c===e.FeatureService)q(a,s,r);else if(c===e.GeocodeService){const e=l===o.ResultPanel?u:null,t=N(r,e,a,l);i.push(t)}}return Promise.all(i)})({serviceList:y.current,searchText:t,searchResultView:E,id:w}).then((e=>{t&&pe(t)})))},pe=e=>{E===o.OtherWidgets?(Ne(),e&&(je()?Oe():he())):fe()},he=()=>{const e=k(y.current,$,w);Promise.all([e]).then((e=>{let o=[],t=[];null==e||e.forEach((e=>{o=o.concat(e)})),o.forEach((e=>{const o=(null==e?void 0:e.records)||[];t=t.concat(o)})),(null==t?void 0:t.length)>0?Oe():fe()}))},fe=()=>{k(y.current,$,w,!0),ue(!0)},je=()=>{let e=[];return ne.forEach((o=>{e=e.concat(null==o?void 0:o.suggestionItem)})),e.length>0},Re=e=>{(e=>{const{searchText:o,id:t,recentSearchesMaxNumber:n,isShowRecentSearches:r}=e,l=`${t}_recent_searches`;if(!r||!o)return!1;let s=F(t);s.includes(o)||(s.unshift(o),s=s.splice(0,n||10),localStorage.setItem(l,escape(s.join("/@/"))))})({searchText:e,id:w,recentSearchesMaxNumber:M,isShowRecentSearches:D})},Oe=()=>{var e;if(!(null==S?void 0:S.current))return!1;null===(e=null==S?void 0:S.current)||void 0===e||e.click()},Ne=()=>{const e=k(y.current,$,w,!0);Promise.all([e])},Ce=we((()=>(e=>{let o,t;return(null==e?void 0:e.linkType)&&(o=null==e?void 0:e.openType,t={linkType:null==e?void 0:e.linkType},t.value=null==e?void 0:e.value),{linkTo:t,target:o}})(P)),[P]),De=(e,o)=>{X&&Y(!1),re([]),U(e),ke(e,o)},Me=()=>{var o;let t=(0,r.Immutable)({});null===(o=null==j?void 0:j.asMutable({deep:!0}))||void 0===o||o.forEach((o=>{if(!(null==o?void 0:o.enable))return!1;const{configId:n}=o;let r;r=(null==o?void 0:o.searchServiceType)===e.GeocodeService?Te(o):Pe(o),t=t.setIn([n],r)})),te(null==t?void 0:t.asMutable({deep:!0}))},Pe=o=>{if(!(null==o?void 0:o.enable)||(null==o?void 0:o.searchServiceType)===e.GeocodeService)return!1;const{configId:t,useDataSource:n,displayFields:r,searchFields:l,searchExact:s,hint:i,searchServiceType:a}=o,c=(null==oe?void 0:oe[t])||{},u={useDataSource:n,displayFields:r,searchFields:l,searchExact:s,maxSuggestions:null==x?void 0:x.maxSuggestions,resultMaxNumber:$,hint:i,searchServiceType:a,configId:t};return Object.assign(c,u)},Te=o=>{if(!(null==o?void 0:o.enable)||(null==o?void 0:o.searchServiceType)===e.FeatureService)return!1;const{configId:t,hint:n,geocodeURL:r,outputDataSourceId:l,label:s,searchServiceType:i}=o,a=(null==oe?void 0:oe[t])||{},c={hint:n,geocodeURL:r,outputDataSourceId:l,icon:null==o?void 0:o.icon,maxSuggestions:null==x?void 0:x.maxSuggestions,resultMaxNumber:$,label:s,searchServiceType:i,configId:t};return Object.assign(a,c)},ke=(o,t)=>{var n,l;const s=oe;for(const t in oe){const r=null===(l=null===(n=oe[t])||void 0===n?void 0:n.useDataSource)||void 0===l?void 0:l.dataSourceId;if(oe[t].searchServiceType===e.GeocodeService||!_(r))continue;const i=L(r),a=J(o,oe[t].searchFields||[],i,oe[t].searchExact||!1);s[t].SQL=a}te(s),((e,o)=>{const{configId:t,magicKey:n,isFromSuggestion:l}=o||{};let s=t?(0,r.Immutable)({}).setIn([t],e[t]):(0,r.Immutable)(e);for(const e in s)n&&(s=s.setIn([e,"magicKey"],n||null)),l&&(s=s.setIn([e,"isFromSuggestion"],l||null));y.current=null==s?void 0:s.asMutable({deep:!0}),ee(null==s?void 0:s.asMutable({deep:!0}))})(s,t)},Le=e=>{if(!e&&D){const e=F(w);if(0===(null==e?void 0:e.length))return!1;const o=e.map((e=>({suggestionHtml:e,suggestion:e,isRecentSearche:!0})));re([{suggestionItem:o,layer:null,icon:null}]),W(!0),Y(!0)}},Ee=()=>z(oe),Fe=V&&!K&&!le;return(0,r.jsx)("div",{className:`h-100 align-items-center d-flex flex-grow-1 ${b||""}`,css:ae},(0,r.jsx)("div",{className:"h-100 flex-grow-1 search-input-con"},O&&(0,r.jsx)(l.TextInput,{value:B||"",onChange:e=>{var o;const t=null===(o=null==e?void 0:e.target)||void 0===o?void 0:o.value,n=(null==t?void 0:t.length)>2;if(De(t),ue(!1),!n)return W(!1),!1;!K&&Q(!0),f.current(t)},onFocus:e=>{var o;const t=null===(o=null==e?void 0:e.target)||void 0===o?void 0:o.value;Le(t),t||!(null==x?void 0:x.isUseCurrentLoation)||V||(W(!0),Le||re([{suggestionItem:[],layer:null,icon:null}]))},onKeyUp:e=>{var o;if(!e||!e.target)return;const t=null===(o=null==e?void 0:e.target)||void 0===o?void 0:o.value;13===e.keyCode&&de()&&(De(t),ge(t))},className:"h-100 w-100",suffix:(0,r.jsx)("div",{className:"d-flex align-items-center"},K&&(0,r.jsx)("div",{className:"loading-con mr-1"}),B&&(null==B?void 0:B.length)>0&&(0,r.jsx)(l.Button,{icon:!0,type:"tertiary",size:"sm",onClick:()=>{De(""),ce(),ue(!1),ge("",!0)}},(0,r.jsx)(Se,null))),placeholder:(()=>{var e,o;let t;const n=Ee();for(const n in oe)t=(null===(e=null==oe?void 0:oe[n])||void 0===e?void 0:e.hint)&&(null===(o=null==oe?void 0:oe[n])||void 0===o?void 0:o.hint);const r=(null==x?void 0:x.hint)||g("findAddressOrPlace");return t=t||r,1!==n?r:t})()})),(0,r.jsx)(l.Button,{className:"search-button h-100",type:"primary",icon:!0,onClick:()=>{(e=>{A===t.Style2?(C(!O),W(!1)):de()&&ge(e)})(B)},title:g("SearchLabel")},(0,r.jsx)(me,null)),(0,r.jsx)(ie,{serviceList:(0,r.Immutable)(Z),canUseOutoutDsLength:Ee(),isOpen:Fe,reference:I,searchText:B,searchSuggestion:ne,toggel:()=>{W(!V)},onRecordItemClick:(e,o)=>{De(e,o),ge(e)},isRecentSearches:X,clearSearches:()=>{(e=>{const o=`${e}_recent_searches`;localStorage.setItem(o,"")})(w),re([]),W(!1),Y(!1)},isShowCurrentLocation:null==x?void 0:x.isUseCurrentLoation}),le&&(0,r.jsx)(ve,{serviceList:(0,r.Immutable)(Z),config:x,reference:I,searchText:B,id:w}),E===o.OtherWidgets&&(0,r.jsx)("div",{className:"search-link-con"},(0,r.jsx)(l.Link,{ref:S,to:null==Ce?void 0:Ce.linkTo,target:null==Ce?void 0:Ce.target,queryObject:m})))},Re=e=>{const{datasourceConfig:o,id:t}=e;return(0,r.jsx)("div",null,null==o?void 0:o.map((e=>(e=>{const{configId:o}=e,n=null==e?void 0:e.outputDataSourceId,l=null==e?void 0:e.useDataSource,s={dataSourceId:n,mainDataSourceId:n};return(0,r.jsx)("div",{key:`${o}_con`},l&&(0,r.jsx)(r.DataSourceComponent,{useDataSource:(0,r.Immutable)(l),query:null,key:`${o}_useDataSource`,widgetId:t}),n&&(0,r.jsx)(r.DataSourceComponent,{useDataSource:(0,r.Immutable)(s),query:null,key:`${o}_outputDataSource`,widgetId:t}))})(e))))},{useEffect:Oe,useState:Ne,useRef:Ce}=r.React,De=e=>{var o;const{config:n,id:l}=e,s=Ce(null),[i,a]=Ne((0,r.Immutable)([])),[c,u]=Ne(!1);Oe((()=>{v()}),[n]);const d=r.css`
    & {
      height: ${r.polished.rem(32)};
      margin-top: 1px;
      margin-left: 1px;
    }
  `,v=()=>{const e=(null==n?void 0:n.datasourceConfig)||(0,r.Immutable)([]),o=[];e.forEach((e=>{var t;const n=null===(t=e)||void 0===t?void 0:t.setIn(["enable"],!0);o.push(n)})),a((0,r.Immutable)(o))},g=()=>(null==n?void 0:n.arrangementStyle)===t.Style1||c;return(0,r.jsx)("div",{className:"widget-search jimu-widget"},(0,r.jsx)("div",{className:"d-flex w-100 align-items-center",css:d,ref:s},(0,r.jsx)("div",null,(null===(o=null==n?void 0:n.datasourceConfig)||void 0===o?void 0:o.length)>1&&g()&&(0,r.jsx)(S,{className:"h-100",config:n,datasourceConfig:i,onDatasourceConfigChange:e=>{e&&a(e)}})),(0,r.jsx)(je,{id:l,className:"flex-grow-1 h-100",reference:s,datasourceConfig:i,config:n,isShowSearchInput:g(),onShowSearchInputChange:e=>{u(e)}}),(0,r.jsx)(Re,{id:l,datasourceConfig:i})))}})(),i})())}}}));